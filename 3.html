<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3 Test</title>
		<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	</head>
<body>

<script type="text/javascript">
//Width and height
var w = 600;
var h = 600;

var coordinates = [0, 0];

//Dynamic, random dataset
var dataset = [];
var dataset2 = [];
var numDataPoints = 100;
for (var i = 0; i < numDataPoints; i++) {
	var newNumber1 = Math.floor(Math.random() * w);
	var newNumber2 = Math.floor(Math.random() * h);
	dataset.push([newNumber1, newNumber2]);
}

//Create SVG element
var svg = d3.select("body")
			.append("svg")
			.attr("width", w)
			.attr("height", h);

//Create circles
svg.selectAll("circle")
   .data(dataset)
   .enter()
   .append("circle")
   .attr("cx", function(d) {
		return d[0];
   })
   .attr("cy", function(d) {
		return d[1];
   })
   .attr("r", 3);

svg.on("mousemove", mousemove);

transition();

function mousemove(d, i) {
//	console.log(d3.mouse(this));
	coordinates = d3.mouse(this);
	console.log(coordinates);
}

function transition() {
	var numValues = dataset.length;
	var Range = 64;
	var radius = 128;

	for (var i = 0; i < numValues; i++) {
		if (Math.sqrt(Math.pow(Math.abs(coordinates[0]-dataset[i][0]),2) + Math.pow(Math.abs(coordinates[1]-dataset[i][1]),2)) < radius) {
			if (coordinates[0] - dataset[i][0] >= 0) {
				if (coordinates[1] - dataset[i][1] >= 0) {
					dataset[i][0] = dataset[i][0] - Math.floor(Math.random() * Range)/2;
					dataset[i][1] = dataset[i][1] - Math.floor(Math.random() * Range)/2;
				} else {
					dataset[i][0] = dataset[i][0] - Math.floor(Math.random() * Range)/2;
					dataset[i][1] = dataset[i][1] + Math.floor(Math.random() * Range)/2;
				}
			} else {
				if (coordinates[1] - dataset[i][1] >= 0) {
					dataset[i][0] = dataset[i][0] + Math.floor(Math.random() * Range)/2;
					dataset[i][1] = dataset[i][1] - Math.floor(Math.random() * Range)/2;
				} else {
					dataset[i][0] = dataset[i][0] + Math.floor(Math.random() * Range)/2;
					dataset[i][1] = dataset[i][1] + Math.floor(Math.random() * Range)/2;
				}
			}
		} else {
			if ((dataset[i][0] + Range/2) >= w) {
				dataset[i][0] = dataset[i][0] - Math.floor(Math.random() * Range)/2;
			} else {
				if (dataset[i][0] <= Range/2) {
					dataset[i][0] = dataset[i][0] + Math.floor(Math.random() * Range)/2;
				} else {
					dataset[i][0] = dataset[i][0] + Math.floor(Math.random() * Range) - Range/2;
				}
			}
			if ((dataset[i][1] + Range/2) >= w) {
				dataset[i][1] = dataset[i][1] - Math.floor(Math.random() * Range)/2;
			} else {
				if (dataset[i][1] <= Range/2) {
					dataset[i][1] = dataset[i][1] + Math.floor(Math.random() * Range)/2;
				} else {
					dataset[i][1] = dataset[i][1] + Math.floor(Math.random() * Range) - Range/2;
				}
			}
		}
	}

	//Update all circles
	svg.selectAll("circle")
		.data(dataset)
		.transition()
		.duration(100)
		.attr("cx", function(d) {
			return d[0];
		})
		.attr("cy", function(d) {
			return d[1];
		});
}
// infinite loop
setInterval(function() {
	transition();
}, 100);

</script>

</body>
</html>